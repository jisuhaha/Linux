2023.12.14
----
## disk partition 
#### MBR(Master Boot Record)Partition : 부팅정보 저장512byte
<p>fdisk {deviceID}<br>
primary, extend, logical 3개의 영역</p>
<blockquote>
MBR Partition 
Partition 최대크기 2TB
<p>Primary Partition : 주 영역 파티션<br>
: Maximum 4개까지 생성 가능 ( 사용하는 용도에 맞게 사용하지 않거나 1개~4개 까지 조절해서 사용)</p>
<p>Extend Partition :   확장 영역 파티션<br>
: Maximum 1개까지 생성 가능 ( 최대가 1개이기 때문에 사용하지 않거나 1개까지 조절해서 사용합니다.)</p>
<p>Ligical Partition :  논리 영역 파티션<br>
Extend Patition 안에 만들 수 있는 파티션으로 SCSI 한 개의 총 파티션 15개만 넘지 않는 범위에서 자유롭게 만들어서 사용가능. 그러나 12개 이상의 파티션을 만드는 것은 시스템에 좋지 않다고 하니 적절하게분배해서 필요<br>
참조 : <a href="https://wlsvud84.tistory.com/14">리눅스 파티션 설정</a></p>

#### GPT Partition 
> UEFI(Undefined Extension Firmware Interface) 펌웨어 실행하는 시스템의 경우 사용 MaxSize 80억 TB
> fdisk가 아닌 parted 명령어 사용
> udevadm settle
> + example : parted /dev/{deviceid} mkpart primary xfs startsector size
> + example : parted /dev/{deviceid} rm {number}

MBR->GPT Able
GPT->MBR disable
    

fdisk 명령어를 통해 partitionSize 증감 불가 

/etc/fstap에  파일시스템 영구적인 마운트가능

#### Swap 명령어
mkswap {deviceID} : swap만듬
swapon deviceID : swap 적용
swapoff deviceID : swap 적용해제

	[root@server nana]# mkswap /dev/nvme0n2p5
	Setting up swapspace version 1, size = 3 GiB (3221221376 bytes)
	no label, UUID=61efe27f-f758-4629-af59-4a5d4566239d
	[root@server nana]# free
				total        used        free      shared  buff/cache   available
	Mem:        3720904      927100     2025376       11072      768428     2542552
	Swap:       3145724           0     3145724
	[root@server nana]# swapon /dev/nvme0n2p5
	[root@server nana]# free
				total        used        free      shared  buff/cache   available
	Mem:        3720904      929980     2022396       11072      768528     2539636
	Swap:       6291448           0     6291448

/etc/fstap에 Type Swap지정을 통해 영구적인 할당

	MBR의 경우 Partition msdos
	[root@server nana]# parted /dev/nvme0n2 print
	Model: NVMe Device (nvme)
	Disk /dev/nvme0n2: 32.2GB
	Sector size (logical/physical): 512B/512B
	Partition Table: msdos
	Disk Flags: 
	
	Number  Start   End     Size    Type      File system     Flags
	1      1049kB  3222MB  3221MB  primary   xfs             lba
	2      3222MB  7517MB  4295MB  primary   ext4
	3      7517MB  10.7GB  3221MB  primary   xfs
	4      10.7GB  32.2GB  21.5GB  extended
	5      10.7GB  14.0GB  3221MB  logical   linux-swap(v1)
	6      14.0GB  17.2GB  3221MB  logical

<br>

	GPT의 경우 partition Table gpt
	[root@client ~]# parted /dev/nvme0n2 print
	Model: VMware Virtual NVMe Disk (nvme)
	Disk /dev/nvme0n2: 42.9GB
	Sector size (logical/physical): 512B/512B
	Partition Table: gpt
	Disk Flags: 
	
	Number  Start   End     Size    File system  Name      Flags
	1      1049kB  4000MB  3999MB               primary
	2      4000MB  8000MB  3999MB               primary
	3      8000MB  12.0GB  4000MB               primary
	4      12.0GB  16.0GB  4000MB               primary4
	5      16.0GB  20.0GB  3999MB               primary5
	
### LVM(Logical Volume Manager)

![](https://velog.velcdn.com/images/pearpearb/post/4f085891-ba9e-4c9c-ae29-bf47ef6c9436/image.png)

>- 물리 장치
>논리 볼륨은 데이터를 저장하는 데 물리 장치를 사용합니다. 이러한 장치는 디스크 파티션, 전체 디스크,
>RAID 어레이 또는 SAN 디스크일 수 있습니다. 장치를 LVM 물리 볼륨으로 초기화해야 합니다. 하나의 LVM 물리 볼륨이 전체 물리 장치를 사용해야 합니다.
>
>- PV(물리 볼륨)
>LVM은 기본 물리 장치를 LVM 물리 볼륨으로 사용합니다. LVM 툴은 물리 볼륨을 PE(물리 확장)로 분할하 여 PV에서 가장 작은 스토리지 블록 역할을 하는 작은 데이터 청크를 형성합니다.
>
>- VG(볼륨 그룹)
>볼륨 그룹은 하나 이상의 PV로 구성된 스토리지 풀입니다. 실제 스토리지와 비교하여 기능적으로 전체
>디스크와 동일합니다. 하나의 PV는 단일 VG에만 할당할 수 있습니다. LVM은 PE 크기를 자동으로 설정하 며, 지정할 수도 있습니다. VG는 사용되지 않은 공간과 여러 논리 볼륨으로 구성될 수 있습니다.
>
>- LV(논리 볼륨)
>논리 볼륨은 VG의 사용하지 않는 물리 확장 영역에서 생성되며 애플리케이션, 사용자, 운영 체제를 위한
>스토리지 장치로 제공됩니다. LV는 물리 확장 영역에 매핑되는 LE(논리 확장 영역)의 컬렉션입니다. 기본 적으로 각 LE는 하나의 PE에 매핑됩니다. 특정 LV 옵션을 설정하면 이 매핑이 변경됩니다. 예를 들어, 미 러링의 경우 각 LE가 두 개의 PE에 매핑됩니다.

How to use LVM on Cent8

> - pvcreate : 물리볼륨  만들기 
> [root@server ~]# pvcreate /dev/nvme0n2p1 /dev/nvme0n2p2 /dev/nvme0n2p3 /dev/nvme0n2p5
  Physical volume "/dev/nvme0n2p1" successfully created.
  Physical volume "/dev/nvme0n2p2" successfully created.
  Physical volume "/dev/nvme0n2p3" successfully created.
  Physical volume "/dev/nvme0n2p5" successfully created.
 >
>- pvs : 물리볼륨 조회 (pvdisplay도 사용)

>- vgcreate : 볼륨 그룹 만들기
[root@server ~]# vgcreate vg1 /dev/nvme0n2p1 /dev/nvme0n2p2 /dev/nvme0n2p3 /dev/nvme0n2p5
  Volume group "vg1" successfully created
>  
>- vgs :   볼륨 그룹 조회 (vgdisplay도 사용)
[root@server ~]# vgs
  VG  #PV #LV #SN Attr   VSize   VFree 
  cs    1   2   0 wz--n- <29.00g     0 
  vg1   4   0   0 wz--n-  11.98g 11.98g

> - lvcreate : 논리볼륨 만들기
[root@server ~]# lvcreate -n lv1 -L 6g vg1
  Logical volume "lv1" created.
  >
  >- lvs : 논리 본륨 조회 (lvdisplay도 사용)
[root@server ~]# lvs
  LV   VG  Attr       LSize   Pool Origin Data%  Meta%  Move Log Cpy%Sync Convert
  root cs  -wi-ao---- <26.00g                                                    
  swap cs  -wi-ao----   3.00g                                                    
  lv1  vg1 -wi-a-----   6.00g     
<a Hhttps://tech.cloud.nongshim.co.kr/2018/11/23/lvmlogical-volume-manager-1-%EA%B0%9C%EB%85%90/
<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE1MzAyOTQzMTMsLTEwNjIwNDk3NzIsLT
YzNDE4NjEwOCw4NzE1Njg2MjMsNjM4MTMwODMsLTU2NTc3NTg4
NywxOTE2NjA1ODIxLC0xNTkxNTkzNTAxLC04NDgwMTU1MTcsND
YyMTc1NjM4LDc3Nzk1NDUyOSwtMTg4MDY1MDc4NSw2OTY3NTE5
ODcsMTEzMDAzMTE3MV19
-->